  <!--================Cart Area =================-->
  <section class="cart_area">
      <div class="container">
          <div class="cart_inner">
              <div class="table-responsive">
                  <table class="table">
                      <thead>
                          <tr>
                              <th scope="col">Product</th>
                              <th scope="col">Price</th>
                              <th scope="col">Quantity</th>
                              <th scope="col">Total</th>
                          </tr>
                      </thead>
                      <tbody>

                            <% for item in cart_details %>
                                <tr>
                                    <td>
                                        <div class="media">
                                            <div class="d-flex">
                                                <img width="50px" src="<%= item.image %>" alt="">
                                            </div>
                                            <div class="media-body">
                                                <p><%= item.name %></p>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <h5 id="item-price">&#8358;<span class="item-price"><%= item.price %></span></h5>
                                    </td>
                                    <td>
                                        <div class="product_count">
                                            <input type="number" name="qty" id="sst" min="1" value="<%= session[:cart][item.id.to_s] %>" title="Quantity:"
                                                class="input-text qty">                                      
                                        </div>
                                    </td>
                                    <td>
                                        <h5>&#8358;<span class="item-total"><%= item.price * session[:cart][item.id.to_s].to_i %></span>
                                        </h5>
                                    </td>
                                </tr>
                            <% end %>
                          
                          <tr class="bottom_button">
                              <td>
                                  <a class="button" href="#">Update Cart</a>
                              </td>
                              <td>

                              </td>
                              <td>

                              </td>
                              <td>
                                  <div class="cupon_text d-flex align-items-center">
                                      <input type="text" placeholder="Coupon Code">
                                      <a class="primary-btn" href="#">Apply</a>
                                      <a class="button" href="#">Have a Coupon?</a>
                                  </div>
                              </td>
                          </tr>
                          <tr>
                              <td>

                              </td>
                              <td>

                              </td>
                              <td>
                                  <h5>Subtotal</h5>
                              </td>
                              <td>
                                  <h5>&#8358;<span id="sub-total"><%= cart_total %></span></h5>
                              </td>
                          </tr>
                          <tr class="shipping_area">
                              <td class="d-none d-md-block">

                              </td>
                              <td>

                              </td>
                              <td>
                                  <h5>Shipping</h5>
                              </td>
                              <td>
                                  <div class="shipping_box">
                                      <ul class="list">
                                          <li><a href="#">Flat Rate: $5.00</a></li>
                                          <li><a href="#">Free Shipping</a></li>
                                          <li><a href="#">Flat Rate: $10.00</a></li>
                                          <li class="active"><a href="#">Local Delivery: $2.00</a></li>
                                      </ul>
                                      <h6>Calculate Shipping <i class="fa fa-caret-down" aria-hidden="true"></i></h6>
                                      <select class="shipping_select">
                                          <option value="1">Bangladesh</option>
                                          <option value="2">India</option>
                                          <option value="4">Pakistan</option>
                                      </select>
                                      <select class="shipping_select">
                                          <option value="1">Select a State</option>
                                          <option value="2">Select a State</option>
                                          <option value="4">Select a State</option>
                                      </select>
                                      <input type="text" placeholder="Postcode/Zipcode">
                                      <a class="gray_btn" href="#">Update Details</a>
                                  </div>
                              </td>
                          </tr>
                          <tr class="out_button_area">
                              <td class="d-none-l">

                              </td>
                              <td class="">

                              </td>
                              <td>

                              </td>
                              <td>
                                  <div class="checkout_btn_inner d-flex align-items-center">
                                      <a class="gray_btn" href="category.html">Continue Shopping</a>
                                      <a class="primary-btn ml-2" href="checkout.html">Proceed to checkout</a>
                                  </div>
                              </td>
                          </tr>
                      </tbody>
                  </table>
              </div>
          </div>
      </div>
  </section>
  <!--================End Cart Area =================-->

  <script>
    const qtyInput = document.querySelectorAll('.qty')

    let subTotal = 0

    const calcSubTotal = () => {
        itemTotals = document.querySelectorAll('.item-total');

        itemTotals.forEach(element => {
            subTotal += parseInt(element.textContent)
        });

        document.querySelector('#sub-total').textContent = subTotal.toFixed(2)
        subTotal = 0
    }

    const calcItemPrices = function() {
        let itemParent = this.closest('tr');
        let price = itemParent.querySelector('.item-price').textContent;
        let quantity = itemParent.querySelector('.qty').value

        itemParent.querySelector('.item-total').textContent = (price * quantity).toFixed(2)

        calcSubTotal()
        
    };

    qtyInput.forEach(element => {
      element.addEventListener('change', calcItemPrices, false);
    });

  </script>